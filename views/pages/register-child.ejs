<%- include('../partials/head') %>
    <script>
      document.addEventListener("DOMContentLoaded", () => {

        fetch("/api/parents/current", { credentials: "include" })
          .then((res) => res.json())
          .then((data) => {
            if (data.parent) {
              const parent = data.parent;
              document.getElementById("parent_id").value = parent.id;
              document.getElementById("parent_email").value = parent.email;
              document.getElementById("parent_number").value = parent.phone_number;
              document.getElementById("parent_home_address").value = parent.home_address;
            }
          })
          .catch((err) => console.error("Error fetching parent:", err));

        const form = document.getElementById("childForm");
        form.addEventListener("submit", (e) => {
          e.preventDefault();

          const formData = new FormData(form);
          const data = Object.fromEntries(formData.entries());

          fetch("/api/children/register", {
            method: "POST",
            credentials: "include",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          })
            .then((res) => res.json())
            .then((result) => {
              if (result.message) {
                // optional quick feedback then redirect to track child page
                // you can remove the alert if you prefer silent redirect
                alert("Child registered successfully!");
                window.location.href = "/track-child";
              } else {
                alert("Failed to register child.");
              }
            })
            .catch((err) => {
              console.error("Error:", err);
              alert("Error registering child.");
            });
        });
      });
    </script>
 


<body>  
   
  <%- include('../partials/top-nav-parents') %>
  
  <div class="main-container">
    <%- include('../partials/side-nav-parents') %>

        <style>
  body {
    font-family: "Roboto", sans-serif;
    background-color: #c54478;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
  }

  
  .logo-container {
    text-align: center;
    margin: 0 auto 20px; 
    width: 380px; 
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 2;
  }

  .map-pin {
    position: relative;
    width: 120px;
    height: 120px;
    background-color: #692e69;
    border-radius: 50% 50% 50% 0;
    transform: rotate(-45deg);
    margin: 0 auto 15px;
  }

  .pin-center {
    position: absolute;
    top: 25%;
    left: 25%;
    width: 60px;
    height: 60px;
    background-color: white;
    border-radius: 50%;
    transform: rotate(45deg);
  }

  .logo-text {
    font-size: 28px;
    font-weight: bold;
    text-align: center;
    margin: 0;
  }

  .white-text { color: #ffffff; }
  .yellow-text { color: #ffff00; }

  
  .register-form {
    background-color: white;
    border-radius: 20px;
    width: 380px;
    padding: 40px 35px;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0 auto; 
  }

  .register-form h1 {
    color: #692e69;
    text-align: center;
    margin-bottom: 30px;
  }

  .input-group {
    position: relative;
    width: 100%;
    margin-bottom: 25px;
  }

  .input-group input,
  .input-group select {
    width: 100%;
    padding: 14px 12px;
    border: 2px solid #ccc;
    border-radius: 10px;
    outline: none;
    font-size: 16px;
    background: none;
    box-sizing: border-box;
  }

  .input-group label {
    position: absolute;
    left: 14px;
    top: 14px;
    color: #888;
    background: white;
    transition: 0.3s ease;
    padding: 0 5px;
    pointer-events: none;
  }

  .input-group input:focus + label,
  .input-group input:not(:placeholder-shown) + label,
  .input-group select:focus + label,
  .input-group select:not([value=""]) + label {
    top: -10px;
    left: 10px;
    font-size: 12px;
    color: #692e69;
  }

  .register-form button {
    background-color: #692e69;
    color: white;
    border: none;
    padding: 12px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    width: 100%;
    transition: background-color 0.3s;
  }

  .register-form button:hover {
    background-color: #8b3c8b;
  }

  .register-form p {
    text-align: center;
    margin-top: 15px;
    color: #333;
  }

  .register-form a {
    color: #692e69;
    text-decoration: none;
    font-weight: bold;
  }

  .register-form a:hover {
    text-decoration: underline;
  }

  
  @media (max-width: 500px) {
    .register-form {
      width: 90%;
      padding: 30px 20px;
    }

    .map-pin {
      width: 100px;
      height: 100px;
    }

    .pin-center {
      width: 50px;
      height: 50px;
      top: 25%;
      left: 25%;
    }

    .logo-text {
      font-size: 24px;
    }
  }
  .content-column {
      width: 380px;
      margin: 20px auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      clear: both; 
      z-index: 2;
    }
</style>
<div class="content-column">
<div class="logo-container">
  <div class="map-pin">
    <div class="pin-center"></div>
  </div>
  <h1 class="logo-text">
    <span class="white-text">GetSet</span> <span class="yellow-text">Kiddies</span>
  </h1>
</div>

<div class="register-form">
  <h1>Register Your Child</h1>

  <form id="childForm">
     
    <input type="hidden" id="parent_id" name="parent_id" />
    <input type="hidden" id="parent_email" name="parent_email" />
    <input type="hidden" id="parent_number" name="parent_number" />
    <input type="hidden" id="parent_home_address" name="parent_home_address" />

    <div class="input-group">
      <input type="text" name="firstname" id="firstname" placeholder=" " required />
      <label for="firstname">Child First Name</label>
    </div>

    <div class="input-group">
      <input type="text" name="lastname" id="lastname" placeholder=" " required />
      <label for="lastname">Child Last Name</label>
    </div>

    <div class="input-group">
      <input type="number" name="child_age" id="child_age" placeholder=" " required />
      <label for="child_age">Child Age</label>
    </div>

    <div class="input-group">
      <select name="child_gender" id="child_gender" required>
        <option value="" disabled selected>Select Gender</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
      </select>
      <label for="child_gender">Child Gender</label>
    </div>

    <button type="submit">Register Child</button>
    <p>Already registered? <a href="/geofence-setup">Set Geofence</a></p>
  </form>
</div></div>

    </main>
  </div>
  <%- include('../partials/footer') %>
</body>

